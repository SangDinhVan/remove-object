dataset:
  root_dir: "data"               
  image_size: 512              
  extensions: [".jpg", ".jpeg", ".png"]
  binary_mask: true              

model:
  name: "mat_lama_net"       
  in_channels: 4                   # RGB + mask
  encoder_name: "resnet50"  # b0/b1/b2/b3... tùy bạn
  pretrained: true                 # load pretrained EfficientNet

  # MAT model only:
  mat:
    style_dim: 256
    n_heads: 8
    d_ff: 2048
    num_layers: 4
    dropout: 0.0
    bottleneck_dim: 512
    smm_hidden: 25                                     # hidden size trong FFN
    use_mask_attn: false          # nếu true thì MAT dùng mask làm attn bias

train:
  batch_size: 8
  num_workers: 4
  epochs: 50
  lr: 1e-4
  lr_D: 1e-4
  weight_decay: 0.0
  device: "cuda"
  warmup_epochs: 3
  min_lr: 1e-

loss:
  rec_weight: 1.0
  hole_weight: 6.0
  valid_weight: 1.0
  perceptual_weight: 0.1   # nếu muốn dùng perceptual
  gan_weight: 0.1          # bật GAN
  r1_gamma: 10.0
           

optimizer:
  type: "adam"                     # adam / adamw
  betas: [0.9, 0.999]

scheduler:
  type: "none"                     # cosine / step / none
  cosine:
    T_max: 50
  step:
    step_size: 20
    gamma: 0.5

checkpoint:
  save_dir: "checkpoints"
  save_interval: 5
  resume: ""                       # path checkpoint để resume

logging:
  log_interval: 20                # in log mỗi N batch
  save_samples: true              # lưu sample image mỗi epoch
  sample_dir: "samples"

